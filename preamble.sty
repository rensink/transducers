\usepackage{xspace}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{mathtools}
%\usepackage{fdsymbol}
\usepackage{MnSymbol}
\usepackage{stmaryrd}
\usepackage{hyperref}
\usepackage[inline]{enumitem}
\setlist{itemsep=0pt}
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{cleveref}
\usepackage{ulem}
\renewcommand{\ULdepth}{.7pt}
\normalem
\usepackage{comment}
\usepackage{algorithm}
\usepackage{centernot}
\usepackage[noend]{algpseudocode}
\algrenewcommand{\algorithmicfor}{{\bfseries\sffamily for}}
\algrenewcommand{\algorithmicif}{{\bfseries\sffamily if}}
\algrenewcommand{\algorithmicelse}{{\bfseries\sffamily else}}
\algrenewcommand{\algorithmicthen}{{\bfseries\sffamily then}}
\algrenewcommand{\algorithmicdo}{{\bfseries\sffamily do}}
\usepackage{multicol}
\usepackage{bussproofs}
\usepackage{tikz}
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{calc}

\newcommand{\dom}{\mathop{\mathrm{dom}}}
\newcommand{\True}{\mathbf{true}}
\newcommand{\False}{\mathbf{false}}
\newcommand{\Trnt}{\mathsf{T}}
\newcommand{\trnt}[1][]{{\circ^{#1}}}
\newcommand{\Stdy}{\mathsf{S}}
\newcommand{\stdy}[1][]{{\bullet^{#1}}}
\newcommand{\Final}{\mathsf{F}}
\newcommand{\internal}{{\odot}}
\newcommand{\final}{{\uparrow}}
\newcommand{\cfinal}{{\upmapsto}}
\newcommand{\present}[1][]{{\color{gray}\bullet^{#1}}}

\newcommand{\qinit}{\iota}
\newcommand{\Lab}{\Lambda}
\newcommand{\emptystr}{\epsilon}

\newcommand{\orelse}{\mathbin{?}}
\newcommand{\alap}{\mathop{!}}
\newcommand{\on}{\mathbin{{:}{:}}}
\newcommand{\abs}{\mathbin{\Uparrow}}
\newcommand{\tries}{\mathrel{\mathit{tries}}}
\newcommand{\cando}{\mathrel{\mathit{can}}}
\newcommand{\ncando}{\centernot{\cando}}
\newcommand{\ifnot}{{\hat{\;}}}
\newcommand{\term}{\varepsilon}
\newcommand{\dead}{\delta}
\newcommand{\close}[1]{\bar{#1}}
\newcommand{\closex}[1]{\overline{#1}}

\newcommand{\sys}[1]{\overline{#1}}

\newcommand{\LTduce}{\mathbf{LT}}
\newcommand{\STduce}{\mathbf{ST}}
\newcommand{\any}{\_}
\newcommand{\Traces}{\mathit{traces}}

\newcommand{\ruleis}{\;::=\;}
\newcommand{\rulemid}{\:\mid\:}

\newcommand{\rC}{\mathsf{C}}
\newcommand{\rF}{\mathsf{F}}
\newcommand{\rR}{\mathsf{R}}
\newcommand{\rS}{\mathsf{S}}

%\newcommand{\a}{\mathsf{a}}
%\newcommand{\c}{\mathsf{c}}

\newcommand{\x}{\mathsf{x}}
\newcommand{\y}{\mathsf{y}}
\newcommand{\z}{\mathsf{z}}
\newcommand{\dont}{}

\newcommand{\cC}{\mathcal{C}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\cI}{\mathcal{I}}
\newcommand{\cP}{\mathcal{P}}
\newcommand{\cR}{\mathcal{R}}
\newcommand{\cS}{\mathcal{S}}
\newcommand{\cU}{\mathcal{U}}

\newcommand{\toS}[1]{\rS(#1)}
\newcommand{\toC}[1]{\rC(#1)}

\newcommand{\LTS}{\mathbf{LTS}}
\newcommand{\CA}{\mathbf{CA}}
\newcommand{\SA}{\mathbf{SA}}

\newcommand{\eone}{\mathsf{e}_1}
\newcommand{\etwo}{\mathsf{e}_2}
\newcommand{\emin}{\mathsf{s}}
\newcommand{\beans}{\mathsf{b}}
\newcommand{\refill}{\mathsf{r}}
\newcommand{\money}{\mathsf{m}}
\newcommand{\coffee}{\mathsf{c}}

\newcommand{\natN}{\mathbb{N}}
\newcommand{\boolB}{\mathbb{B}}

\newcommand{\setof}[1]{\{{#1}\}}
\newcommand{\gensetof}[2]{\setof{{#1}\mid{#2}}}
\newcommand{\tupof}[1]{\langle{#1}\rangle}
\newcommand{\powersetof}[1]{\cP({#1})}
\newcommand{\iffdef}{:\Leftrightarrow}
\newcommand{\isdef}{:=}
% Partial function
\newcommand{\pto}{\hookrightarrow}
% Such that
\newcommand{\st}{.\,}

\newenvironment{inumerate}{%
  \begin{enumerate*}[label=\emph{(\roman*)}]
}{%
  \end{enumerate*}%
}

\newcommand{\bis}{\mathrel{\rho}}

% Special arrows
\newcommand{\movesto}{\rightsquigarrow}
\newcommand{\nmovesto}{\nrightsquigarrow}

% Typeset the label of an extensible arrow by lowering the text
\newcommand{\lowerlabel}[1]{\smash{\mathchoice
		{\raisebox{-1.5pt}{$\scriptstyle#1$}}
		{\raisebox{-1.5pt}{$\scriptstyle#1$}}
		{\raisebox{-1pt}{$\scriptstyle#1$}}
		{\raisebox{-1pt}{$\scriptscriptstyle#1$}}
}}
% Typeset the label of an extensible arrow by lowering the text further
\newcommand{\lowerlabelx}[1]{\smash{\mathchoice
		{\raisebox{-3pt}{$\scriptstyle#1$}}
		{\raisebox{-3pt}{$\scriptstyle#1$}}
		{\raisebox{-2pt}{$\scriptstyle#1$}}
		{\raisebox{-2pt}{$\scriptscriptstyle#1$}}
}}
% Typeset the lower label of an extensible arrow by raising the text
\newcommand{\raiselabel}[1]{\smash{\mathchoice
		{\raisebox{1.5pt}{$\scriptstyle#1$}}
		{\raisebox{1.5pt}{$\scriptstyle#1$}}
		{\raisebox{1pt}{$\scriptstyle#1$}}
		{\raisebox{1pt}{$\scriptscriptstyle#1$}}
}}
% Typeset the lower label of an extensible arrow by raising the text further
\newcommand{\raiselabelx}[1]{\smash{\mathchoice
		{\raisebox{3pt}{$\scriptstyle#1$}}
		{\raisebox{3pt}{$\scriptstyle#1$}}
		{\raisebox{2pt}{$\scriptstyle#1$}}
		{\raisebox{2pt}{$\scriptscriptstyle#1$}}
}}
% Typeset the lower label of an extensible arrow by raising the text even further
\newcommand{\raiselabelxx}[1]{\smash{\mathchoice
		{\raisebox{4.5pt}{$\scriptstyle#1$}}
		{\raisebox{4.5pt}{$\scriptstyle#1$}}
		{\raisebox{3pt}{$\scriptstyle#1$}}
		{\raisebox{3pt}{$\scriptscriptstyle#1$}}
}}

% Prepend a negation to an extensible arrow
\newcommand{\xarrownot}{\mathrel{\arrownot-}\mkern-7mu}

% single-arrow transduction
\newcommand{\tducex}{\mapstochar\trans{}}
\newcommand{\ntducex}{\not\tducex{}}
%\newcommand{\tduce}[3][\,]{\mathrel{
%  \smash{\xrightarrow[\raiselabelxx{#3}]{\lowerlabel{#2}}_{\!#1}}
%  \vphantom{\xrightarrow{\lowerlabel{#2}}_{\!#1}}
%}}
\newcommand{\tduce}[3][\,]{\mapstochar\trans[#1]{{#2}{:}{#3}}}
\newcommand{\ntduce}[3][\,]{\not\tduce[#1]{#2}{#3}}

% double-arrow transduction
\newcommand{\Tduce}[3][\,]{\mathrel{
  \smash{\xRightarrow[\raiselabelxx{#3}]{\lowerlabel{#2}}_{\!#1}}
  \vphantom{\xrightarrow{\lowerlabel{#2}}}
}}
%\newcommand{\Tduce}[2]{\Trans{{#1}{\on}{#2}}}

% single-arrow transition
\newcommand{\trans}[2][\,]{\mathrel{\mathchoice
  {\inlinetrans[#1]{#2}}%
  {\inlinetrans[#1]{#2}}%
  {\inlinetrans[#1]{#2}}%
  {\inlinetrans[#1]{#2}}%
}}
\newcommand{\inlinetrans}[2][\,]{\mathrel{%
  \smash{\xrightarrow{\lowerlabel{#2}}_{\!#1}}%
  \vphantom{\xrightarrow{\lowerlabel{#2}}}%
}}
\newcommand{\displaytrans}[2][\,]{\mathrel{%
  \smash{\xrightarrow{\lowerlabel{#2}}_{\!#1}}%
  \vphantom{\xrightarrow{X}}%
}}
% negative single-arrow transition
\newcommand{\ntrans}[2][\,]{\mathrel{\not\trans{#2}}_{\!#1}}

% Reachability up to transient depth
\newcommand{\Reach}[1]{\Rightarrow_{\smash{#1}\vphantom{b}}}

% doublie-arrow transition
\newcommand{\Trans}[2][\,]{\mathchoice
  {\displayTrans[#1]{#2}}
  {\displayTrans[#1]{#2}}
  {\inlineTrans[#1]{#2}}
  {\inlineTrans[#1]{#2}}
}
\newcommand{\inlineTrans}[2][\,]{\mathrel{
  \smash{\xRightarrow{\smash{\lowerlabel{#2}}}_{\!#1}}
  \vphantom{\xrightarrow{\smash{\lowerlabel{#2}}}}
}}
\newcommand{\displayTrans}[2][\,]{\mathrel{
  \smash{\xRightarrow{#2}_{\!#1}}
  \vphantom{\xrightarrow{#2}}
}}
% negative single-arrow transition
\newcommand{\nTrans}[2][\,]{\mathrel{\xarrownot\Trans{#2}}_{\!#1}}

%%%% Recapture the mapstochar, which is set to undefined by MnSymbol
\usepackage{trimclip}

\makeatletter
\providecommand{\mapstochar}{\mathrel{\mathpalette\mapstochar@\relax}}
\newcommand{\mapstochar@}[2]{%
	\makebox[0pt][l]{%
		\clipbox{0 0 {0.8\width} 0}{$\m@th#1\mapsto$}%
	}%
}
\makeatother
